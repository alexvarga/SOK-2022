{% extends "core/base.html" %}

{% block style %}
    <style>

        .node {
            cursor: pointer;
            color: #3182bd;

        }

        .link {
            fill: none;
            stroke: #9ecae1;
            stroke-width: 1.5px;
        }

    </style>
    <script>
        function nodeClick(el) {
            alert("ID: " + el.id);
        }
    </script>
{% endblock %}
{% block content %}

        <svg width="500" height="500">

        </svg>

    <script>



        var data = {

                name: "node_{{root.id}}",
                naziv: "{{root.label}}",
                children: [
                    {% for n, values in nodes.items %}
                        {
                            name: "node_{{n.id}}",
                            naziv: "{{n.label}}",
                            children: [
                                {% for n, values2 in values.items %}
                                                            {
                            name: "node_{{n.id}}",
                            naziv: "{{n.label}}",
                            children: [

                            ]
                        },
                                    {% endfor %}
                            ]
                        },
                    {% endfor %}

                ]

        };



        console.log(data, "hi")


    var svg=d3.select('svg');

        // console.log(data, "ovo je data")
            var tree=d3.layout.tree().size([400,400]);
    var nodes=tree.nodes(data);
    var links=tree.links(nodes);

    //Dodavanje linkova
    var link = svg.selectAll('.link')
        .data(links)
        .enter().append('line')
        .attr('class', 'link')
        .attr('x1', function(d) { return d.source.y; })
        .attr('y1', function(d) { return d.source.x; })
        .attr('x2', function(d) { return d.target.y; })
        .attr('y2', function(d) { return d.target.x; });


    // Dodavanje cvorova
    var node = svg.selectAll('.node')
        .data(nodes) //add
        .enter().append('g')
        .attr('class', 'node')
        .attr('transform', function(d){return "translate("+d.y+","+d.x+")";});


    node.append('circle')
        .attr('r', 10) //radius of circle
        .attr('fill','blue');
    node.append('text')
        .text(function(d){return d.naziv;})

    </script>
{% endblock %}